<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HireFlow</title>
    <link rel="stylesheet" href="../styles/style.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-left">
            <a href="profile.html" class="logo"><img src="../images/logo.png"></a>
        </div>
        <div class="navbar-center">
            <ul>
                <li><a href="#" class="active-link"><img src="../images/home.png"> <span>Home</span></a></li>
                <li><a href="#"><img src="../images/jobs.png"> <span>Jobs</span></a></li>
                <li><a href="#"><img src="../images/message.png"> <span>Messanging</span></a></li>
                <li><a href="#"><img src="../images/notification.png"> <span>Notifications</span></a></li>
            </ul>
        </div>
        <div class="navbar-right">
            <div class="online">
                <img src="../images/user-1.png" class="nav-profile-img" onclick="toggleMenu()">
            </div>
        </div>
        <!-- Profile drop down menu -->
        <div class="profile-menu-wrap" id="profileMenu">
            <div class="profile-menu">
                <div class="user-info">
                    <img src="../images/user-1.png">
                    <div>
                        <h3>Ryan Walton</h3>
                    </div>
                </div>
                <hr>
                <a href="#" class="profile-menu-link">
                    <img src="../images/feedback.png">
                    <p>Give Feedback</p>
                    <span>></span>
                </a>
                <a href="#" class="profile-menu-link">
                    <img src="../images/setting.png">
                    <p>Settings & Privacy</p>
                    <span>></span>
                </a>
                <a href="#" class="profile-menu-link">
                    <img src="../images/help.png">
                    <p>Help & Support</p>
                    <span>></span>
                </a>
                <a href="#" class="profile-menu-link">
                    <img src="../images/display.png">
                    <p>Display & Accesibility</p>
                    <span>></span>
                </a>
                <a href="#" class="profile-menu-link" id="logoutButton">
                    <img src="../images/logout.png">
                    <p>Logout</p>
                    <span>></span>
                </a>
            </div>
        </div>
    </nav>
    <!-------------------- navbar close -------------------->
    <div class="container">
        <div class="profile-main">
            <div class="profile-container">
                <img src="../images/cover-pic.png" alt="" width="100%">
                <div class="profile-container-inner">
                    <img src="../images/user-1.png" class="profile-pic">
                    <h1>Ryan Walton</h1>
                    <b>Web Developer at Microsoft | Former developer at DataStack and Intern at Oracle</b>
                    <p>San Francisco, California, US &middot; <a href="#">Contact info</a></p>
                    <div class="profile-btn">
                        <a href="#" class="primery-btn"><img src="../images/connect.png">Connect</a>
                        <a href="#"><img src="../images/chat.png">Message</a>
                        <a href="#"><img src="../images/paper.png">Download CV</a>
                        <a href="#" onclick="openEditProfileModal()"><img src="../images/pencil.png">Edit Profile</a>
                    </div>
                </div>
            </div>
            <div class="profile-description">
                <h2>About</h2>
                <p>The success of every websites depends on search engine optimisation and digital marketing strategy. If you are on first page of all major search engines then you are ahead among your competitors on first page of all major search engines then you are ahead among your competitors.</p>
                <a href="#" class="see-more-link">See more...</a>
            </div>
            <div class="profile-description">
                <h2>Experience</h2>
                <div class="profile-desc-row">
                    <img src="../images/microsoft.png">
                    <div>
                        <h3>Lead Front-End Developer</h3>
                        <b>Microsoft &middot; Full-time</b>
                        <b>Feb 2021 &middot; 4.6 years</b>
                        <p>Computer programming is the process of performing a particular computation, usually by designing and building an executable computer program.</p>
                        <hr>
                    </div>
                </div>
                <div class="profile-desc-row">
                    <img src="../images/slack.png">
                    <div>
                        <h3>Full Slack Developer</h3>
                        <b>Slack &middot; Full-time</b>
                        <b>June 2018 - Jan 2021 &middot; 2.6 years</b>
                        <p>Computer programming is the process of performing a particular computation, usually by designing and building an executable computer program.</p>
                        <hr>
                    </div>
                </div>
                <div class="profile-desc-row">
                    <img src="../images/google.png">
                    <div>
                        <h3>Web Developer</h3>
                        <b>Google Inc. &middot; Full-time</b>
                        <b>Sept 2012 - May 2018 &middot; 2.8 years</b>
                        <p>Computer programming is the process of performing a particular computation, usually by designing and building an executable computer program.</p>
                        <hr>
                    </div>
                </div>
                <hr>
                <a href="#" class="experience-link">Show all 7 experiences <img src="../images/right-arrow.png"></a>
            </div>
            <div class="profile-description">
                <h2>Education</h2>
                <div class="profile-desc-row">
                    <img src="../images/stanford.png">
                    <div>
                        <h3>Stanford University</h3>
                        <b>BSEE, Electrical Engineering</b>
                        <b>2018 - 2022</b>
                        <hr>
                    </div>
                </div>
                <div class="profile-desc-row">
                    <img src="../images/north.png">
                    <div>
                        <h3>Nortwestern University</h3>
                        <b>Computer Science</b>
                        <b>2015 - 2018</b>
                        <hr>
                    </div>
                </div>
                <div class="profile-desc-row">
                    <img src="../images/mit.png">
                    <div>
                        <h3>Hardvard University</h3>
                        <b>Senior High School</b>
                        <b>2005 - 2015</b>
                    </div>
                </div>
            </div>
            <div class="profile-description">
                <h2>Skills</h2>
                <a href="#" class="skills-btn">Leadership</a>
                <a href="#" class="skills-btn">Web Desing</a>
                <a href="#" class="skills-btn">Development</a>
                <a href="#" class="skills-btn">Communication</a>
                <a href="#" class="skills-btn">UI/UX</a>
                <a href="#" class="skills-btn">Planning</a>
                <a href="#" class="skills-btn">Coding</a>
                <a href="#" class="skills-btn">JavaScript</a>
                <a href="#" class="skills-btn">Python</a>
                <a href="#" class="skills-btn">Enterprenuorship</a>
            </div>
            <div class="profile-description">
                <h2>Languages</h2>
                <a href="#" class="language-btn">English</a>
                <a href="#" class="language-btn">Spanish</a>
                <a href="#" class="language-btn">French</a>
            </div>
        </div>
    </div>
    
    <!-- Modal de ediciÃ³n de perfil -->
    <div class="edit-profile-modal" id="editProfileModal">
        <div class="edit-profile-content">
            <div class="edit-profile-header">
                <h2>Edit Profile</h2>
                <button class="close-modal" onclick="closeEditProfileModal()">&times;</button>
            </div>
            <div class="edit-profile-form">
                <div class="form-section">
                    <h3>Basic Information</h3>
                    <div class="form-group">
                        <label for="profileName">Full Name</label>
                        <input type="text" id="profileName" value="Ryan Walton">
                    </div>
                    <div class="form-group">
                        <label for="profileTitle">Professional Title</label>
                        <input type="text" id="profileTitle" value="Web Developer at Microsoft | Former developer at DataStack and Intern at Oracle">
                    </div>
                    <div class="form-group">
                        <label for="profileLocation">Location</label>
                        <input type="text" id="profileLocation" value="San Francisco, California, US">
                    </div>
                    <div class="form-group">
                        <label for="profileAbout">About</label>
                        <textarea id="profileAbout">The success of every websites depends on search engine optimisation and digital marketing strategy. If you are on first page of all major search engines then you are ahead among your competitors on first page of all major search engines then you are ahead among your competitors.</textarea>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>Experience</h3>
                    <div id="experienceContainer">
                        <div class="experience-item">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expCompany1">Company</label>
                                    <input type="text" id="expCompany1" value="Microsoft">
                                </div>
                                <div class="form-group">
                                    <label for="expPosition1">Position</label>
                                    <input type="text" id="expPosition1" value="Lead Front-End Developer">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expType1">Employment Type</label>
                                    <select id="expType1">
                                        <option value="Full-time" selected>Full-time</option>
                                        <option value="Part-time">Part-time</option>
                                        <option value="Contract">Contract</option>
                                        <option value="Internship">Internship</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="expStartDate1">Start Date</label>
                                    <input type="text" id="expStartDate1" value="Feb 2021">
                                </div>
                                <div class="form-group">
                                    <label for="expEndDate1">End Date</label>
                                    <input type="text" id="expEndDate1" value="Present">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="expDescription1">Description</label>
                                <textarea id="expDescription1">Computer programming is the process of performing a particular computation, usually by designing and building an executable computer program.</textarea>
                            </div>
                            <button class="remove-item" onclick="removeExperience(this)">Remove Experience</button>
                        </div>
                    </div>
                    <button class="add-item-btn" onclick="addExperience()">+ Add Experience</button>
                </div>
                
                <div class="form-section">
                    <h3>Education</h3>
                    <div id="educationContainer">
                        <div class="education-item">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="eduSchool1">School</label>
                                    <input type="text" id="eduSchool1" value="Stanford University">
                                </div>
                                <div class="form-group">
                                    <label for="eduDegree1">Degree</label>
                                    <input type="text" id="eduDegree1" value="BSEE, Electrical Engineering">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="eduStartDate1">Start Date</label>
                                    <input type="text" id="eduStartDate1" value="2018">
                                </div>
                                <div class="form-group">
                                    <label for="eduEndDate1">End Date</label>
                                    <input type="text" id="eduEndDate1" value="2022">
                                </div>
                            </div>
                            <button class="remove-item" onclick="removeEducation(this)">Remove Education</button>
                        </div>
                    </div>
                    <button class="add-item-btn" onclick="addEducation()">+ Add Education</button>
                </div>
                
                <div class="form-section">
                    <h3>Skills</h3>
                    <div class="form-group">
                        <label>Current Skills</label>
                        <div class="skills-container" id="skillsContainer">
                            <div class="skill-tag">Leadership <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">Web Design <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">Development <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">Communication <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">UI/UX <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">Planning <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">Coding <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">JavaScript <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">Python <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                            <div class="skill-tag">Enterpreneurship <span class="remove-tag" onclick="removeSkill(this)">Ã</span></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="newSkill">Add New Skill</label>
                        <div class="form-row">
                            <input type="text" id="newSkill" placeholder="Enter a skill">
                            <button class="btn btn-secondary" onclick="addSkill()">Add</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>Languages</h3>
                    <div class="form-group">
                        <label>Current Languages</label>
                        <div class="languages-container" id="languagesContainer">
                            <div class="language-tag">English <span class="remove-tag" onclick="removeLanguage(this)">Ã</span></div>
                            <div class="language-tag">Spanish <span class="remove-tag" onclick="removeLanguage(this)">Ã</span></div>
                            <div class="language-tag">French <span class="remove-tag" onclick="removeLanguage(this)">Ã</span></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="newLanguage">Add New Language</label>
                        <div class="form-row">
                            <input type="text" id="newLanguage" placeholder="Enter a language">
                            <button class="btn btn-secondary" onclick="addLanguage()">Add</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="closeEditProfileModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="saveProfileChanges()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="profile-footer">
        <div class="sidebar-useful-links">
            <a href="#">About</a>
            <a href="#">Accesibility</a>
            <a href="#">Help Center</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Advertising</a>
            <a href="#">Get the App</a>
            <a href="#">More</a>

            <div class="copyright-msg">
                <img src="../images/logo.png">
                <p>HireFlow &#169; 2025. All rights reserved</p>
            </div>
        </div>
    </div>

    <script src="../js/script.js"></script>
    <script>
    // VerificaciÃ³n de autenticaciÃ³n y manejo de logout
    document.addEventListener('DOMContentLoaded', async function() {
        const authManager = new AuthManager();
        
        try {
            // Verificar si el usuario estÃ¡ autenticado
            const user = await authManager.requireAuth();
            
            if (user) {
                console.log('Usuario autenticado:', user.email);
                // Cargar datos del perfil especÃ­ficos del usuario
                loadUserProfile(user.uid);
                setupLogoutHandler(authManager);
            }
        } catch (error) {
            console.error('Error de autenticaciÃ³n:', error);
        }

        // Configurar el manejador del botÃ³n de logout
        function setupLogoutHandler(authManager) {
            const logoutButton = document.getElementById('logoutButton');
            
            if (logoutButton) {
                logoutButton.addEventListener('click', async function(e) {
                    e.preventDefault();
                    
                    // Mostrar confirmaciÃ³n
                    const confirmLogout = await showLogoutConfirmation();
                    
                    if (confirmLogout) {
                        await performLogout(authManager);
                    }
                });
            }
        }

        // Mostrar diÃ¡logo de confirmaciÃ³n
        async function showLogoutConfirmation() {
            return new Promise((resolve) => {
                Swal.fire({
                    title: 'Â¿Cerrar sesiÃ³n?',
                    text: 'Â¿EstÃ¡s seguro de que quieres salir de tu cuenta?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#045be6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'SÃ­, cerrar sesiÃ³n',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    resolve(result.isConfirmed);
                });
            });
        }

        // Ejecutar el logout
        async function performLogout(authManager) {
            try {
                // Cerrar el menÃº de perfil primero
                closeProfileMenu();
                
                // Mostrar loading
                Swal.fire({
                    title: 'Cerrando sesiÃ³n...',
                    text: 'Por favor espera',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                const result = await authManager.signOut();
                
                if (result.success) {
                    Swal.fire({
                        title: 'Â¡SesiÃ³n cerrada!',
                        text: 'Has cerrado sesiÃ³n exitosamente',
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    }).then(() => {
                        window.location.href = '../index.html';
                    });
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('Error durante el logout:', error);
                Swal.fire({
                    title: 'Error',
                    text: 'No se pudo cerrar la sesiÃ³n: ' + error.message,
                    icon: 'error',
                    confirmButtonText: 'Entendido'
                });
            }
        }

        // FunciÃ³n para cargar el perfil del usuario (existente)
        async function loadUserProfile(userId) {
            try {
                const userDoc = await firebase.firestore().collection('users').doc(userId).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    updateProfileUI(userData);
                }
            } catch (error) {
                console.error('Error cargando perfil:', error);
            }
        }

        function updateProfileUI(userData) {
            // Actualizar nombre si estÃ¡ disponible
            if (userData.fullName) {
                const nameElements = document.querySelectorAll('h1, h3');
                nameElements.forEach(el => {
                    if (el.textContent.includes('Ryan Walton')) {
                        el.textContent = el.textContent.replace('Ryan Walton', userData.fullName);
                    }
                });
            }
            
            // Actualizar email si estÃ¡ disponible
            if (userData.email) {
                const userInfo = document.querySelector('.user-info h3');
                if (userInfo && userInfo.textContent === 'Ryan Walton') {
                    const user = authManager.getCurrentUser();
                    userInfo.textContent = userData.fullName || user.email;
                }
            }
        }
    });
    </script>
</body>
</html>